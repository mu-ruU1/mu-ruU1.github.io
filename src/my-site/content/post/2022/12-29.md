---
title: "ファイアウォールが原因でpingが通らなかった"
description:
date: 2022-12-29T01:39:19+09:00
slug: 2022-12-29
draft: false
toc: true
image: img/2022/12-29/cisco-891f.jpg
categories:
  - ネットワーク
tags: [windows, cisco]
---

## はじめに

ネットワークの勉強のために 7 月頃に Cisco891F を買ったけれども、色々忙しくて全く触れていませんでした。
冬休みになって時間ができたのでこれから勉強していきたいと思います。

## 事の発端

手始めに Cisco891F x 3 を使って[SVI を利用した VLAN 間ルーティング](https://github.com/mu-ruU1/network-study/tree/main/vlan/svi)を試していたところ特定の条件で ping が通らないことが起こりました。  
具体的には、同一 VLAN では ping が通るが異なる VLAN 間では ping が通らないといった状態です。

## 内容

VLAN10(172.16.10.0/24)に所属している PC から VLAN20(172.16.20.0/24)に所属している PC に ping を実行したときの結果が以下のようになりました。

```powershell
PS C:\Users\user> ping 172.16.20.1

172.16.20.1 に ping を送信しています 32 バイトのデータ:
要求がタイムアウトしました。
要求がタイムアウトしました。
要求がタイムアウトしました。
```

tracert を実行したときの結果も載せておきます。

```powershell
PS C:\Users\user> tracert 172.16.20.1

172.16.20.1 へのルートをトレースしています。経由するホップ数は最大 30 です

  1     1 ms     1 ms    <1 ms  172.16.10.254
  2     *        *        *     要求がタイムアウトしました。
  3     *        *        *     要求がタイムアウトしました。
  4     *        *        *     要求がタイムアウトしました。
```

ルーターからはすべての SVI のデフォルトゲートウェイ・PC に ping が通るので PC 側に問題があると思って調べました。

## 解決策

ファイアウォールのプロパティを見たところ、リモート IP アドレスが`ローカル サブサブネット`になっていたことが原因だったことが判明しました。  
という訳で、リモート IP アドレスを`任意のIPアドレス`にすれば ping が通るようになります。

![](img/2022/12-29/firewall.png)
